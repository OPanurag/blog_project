<!DOCTYPE html>
<html>
<head>
    <title>Blog Home</title>
    <style>
        .container {
            display: flex;
            justify-content: space-between;
        }
        .content {
            width: 70%;
        }
        .sidebar {
            width: 25%;
            border-left: 1px solid #ddd;
            padding-left: 20px;
        }
        form {
            display: flex;
            flex-direction: column;
        }
        input, textarea {
            margin-bottom: 10px;
        }
        .hidden {
            display: none;
        }
    </style>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            document.getElementById('loginButton').addEventListener('click', function () {
                window.location.href = '/login/';
            });

            document.getElementById('signupButton').addEventListener('click', function () {
                window.location.href = '/signup/';
            });

            if (localStorage.getItem('token')) {
                fetchPosts();
                document.getElementById('loginSection').classList.add('hidden');
                document.getElementById('postSection').classList.remove('hidden');
            } else {
                document.getElementById('loginSection').classList.remove('hidden');
                document.getElementById('postSection').classList.add('hidden');
            }
        });

        function fetchPosts() {
            const token = localStorage.getItem('token');
            if (!token) {
                return;
            }

            fetch('/api/posts/', {
                headers: {
                    'Authorization': 'Bearer ' + token
                }
            })
            .then(response => response.json())
            .then(data => {
                const postsList = document.getElementById('postsList');
                postsList.innerHTML = '';
                if (data.length) {
                    data.forEach(post => {
                        const postItem = document.createElement('li');
                        postItem.innerHTML = `
                            <h2>${post.title}</h2>
                            <p>${post.content}</p>
                            <p><small>${post.published_date}</small></p>
                        `;
                        postsList.appendChild(postItem);
                    });
                } else {
                    postsList.innerHTML = '<p>No posts available.</p>';
                }
            });
        }
    </script>
</head>
<body>
<div class="container">
    <div class="content">
        <h1>Welcome to the Blog Home Page</h1>

        <div id="loginSection">
            <h2>Login or Sign Up</h2>
            <button id="loginButton">Login</button>
            <button id="signupButton">Sign Up</button>
        </div>

        <div id="postSection" class="hidden">
            <h2>Create a New Post</h2>
            <form id="postForm">
                <label for="title">Title:</label>
                <input type="text" id="title" name="title" required><br>
                <label for="content">Content:</label>
                <textarea id="content" name="content" required></textarea><br>
                <button type="submit">Create Post</button>
            </form>

            <h2>Blog Posts</h2>
            <ul id="postsList">
                <!-- Posts will be populated here by JavaScript -->
            </ul>
        </div>
    </div>
    <div class="sidebar">
        <!-- Sidebar content can be added here if needed -->
    </div>
</div>
</body>
</html>
